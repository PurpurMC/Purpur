From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Ben Kerllenevich <me@notom3ga.me>
Date: Thu, 18 Mar 2021 07:23:27 -0400
Subject: [PATCH] Add config for villager trading


diff --git a/src/main/java/net/minecraft/world/entity/npc/EntityVillager.java b/src/main/java/net/minecraft/world/entity/npc/EntityVillager.java
index 6ad608a795e85daf7425f26041b5e4a86cadc033..22d5e2e6cbc32370177e21f17109a73a58bf7e67 100644
--- a/src/main/java/net/minecraft/world/entity/npc/EntityVillager.java
+++ b/src/main/java/net/minecraft/world/entity/npc/EntityVillager.java
@@ -373,7 +373,7 @@ public class EntityVillager extends EntityVillagerAbstract implements Reputation
                     return tryRide(entityhuman, enumhand); // Purpur
                 } else {
                     if (world.purpurConfig.villagerRidable && itemstack.isEmpty()) return tryRide(entityhuman, enumhand); // Purpur
-                    if (!this.world.isClientSide && !this.trades.isEmpty()) {
+                    if (!this.world.isClientSide && this.world.purpurConfig.allowVillagerTrading && !this.trades.isEmpty()) { // Purpur
                         this.h(entityhuman);
                     }
 
diff --git a/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java b/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
index 1ee973ca154595ddf5dc1560cfd26e9981a7bddf..eeb9dfd8609d756de7b11124f110112e229044ca 100644
--- a/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
+++ b/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
@@ -1712,6 +1712,7 @@ public class PurpurWorldConfig {
     public boolean villagerClericsFarmWarts = false;
     public boolean villagerClericFarmersThrowWarts = true;
     public double villagerMaxHealth = 20.0D;
+    public boolean allowVillagerTrading = true;
     private void villagerSettings() {
         villagerRidable = getBoolean("mobs.villager.ridable", villagerRidable);
         villagerRidableInWater = getBoolean("mobs.villager.ridable-in-water", villagerRidableInWater);
@@ -1739,6 +1740,7 @@ public class PurpurWorldConfig {
             set("mobs.villager.attributes.max_health", oldValue);
         }
         villagerMaxHealth = getDouble("mobs.villager.attributes.max_health", villagerMaxHealth);
+        allowVillagerTrading = getBoolean("mobs.villager.allow-trading", allowVillagerTrading);
     }
 
     public boolean villagerTraderRidable = false;
