From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Encode42 <me@encode42.dev>
Date: Thu, 10 Dec 2020 13:43:28 -0500
Subject: [PATCH] Configurable default collar color

This allows for the server to set a default collar color when a wolf or cat is tamed.
Resets to RED when the value is invalid.

diff --git a/src/main/java/net/minecraft/world/entity/animal/Cat.java b/src/main/java/net/minecraft/world/entity/animal/Cat.java
index a6a61f4a5b3effd34c243a7abd85b7ee4aaed8f0..68ad0796896c197e5c20fc832ca74d2ade341b10 100644
--- a/src/main/java/net/minecraft/world/entity/animal/Cat.java
+++ b/src/main/java/net/minecraft/world/entity/animal/Cat.java
@@ -346,6 +346,14 @@ public class Cat extends TamableAnimal {
         return Mth.lerp(tickDelta, this.relaxStateOneAmountO, this.relaxStateOneAmount);
     }
 
+    // Purpur start
+    @Override
+    public void tame(Player player) {
+        setCollarColor(level.purpurConfig().mobs.cat.defaultCollarColor);
+        super.tame(player);
+    }
+    // Purpur end
+
     @Override
     public Cat getBreedOffspring(ServerLevel world, AgeableMob entity) {
         Cat entitycat = (Cat) EntityType.CAT.create(world);
diff --git a/src/main/java/net/minecraft/world/entity/animal/Wolf.java b/src/main/java/net/minecraft/world/entity/animal/Wolf.java
index 3774d3c7ae4d3aebdbd82049b849df4cf1bace96..d68f423669bdf8593e3a128da9e6b85faac3bb8e 100644
--- a/src/main/java/net/minecraft/world/entity/animal/Wolf.java
+++ b/src/main/java/net/minecraft/world/entity/animal/Wolf.java
@@ -201,6 +201,12 @@ public class Wolf extends TamableAnimal implements NeutralMob {
         this.updatePathfinders(false);
         return super.finalizeSpawn(world, difficulty, type, data, nbt);
     }
+
+    @Override
+    public void tame(Player player) {
+        setCollarColor(level.purpurConfig().mobs.wolf.defaultCollarColor);
+        super.tame(player);
+    }
     // Purpur end
 
     @Override
diff --git a/src/main/java/org/purpurmc/purpur/configuration/PurpurWorldConfiguration.java b/src/main/java/org/purpurmc/purpur/configuration/PurpurWorldConfiguration.java
index 7c2a869a835b4275aca1bace64d1690d963cd0b2..3601ad33806980b2d3de5af5b2980a3f38edf3c8 100644
--- a/src/main/java/org/purpurmc/purpur/configuration/PurpurWorldConfiguration.java
+++ b/src/main/java/org/purpurmc/purpur/configuration/PurpurWorldConfiguration.java
@@ -7,6 +7,7 @@ import net.minecraft.resources.ResourceLocation;
 import net.minecraft.world.entity.animal.Chicken;
 import net.minecraft.world.entity.animal.Fox;
 import net.minecraft.world.entity.npc.Villager;
+import net.minecraft.world.item.DyeColor;
 import net.minecraft.world.item.Item;
 import net.minecraft.world.item.Items;
 import net.minecraft.world.level.Explosion;
@@ -114,6 +115,7 @@ public class PurpurWorldConfiguration extends ConfigurationPart {
         public Cat cat;
         public class Cat extends ConfigurationPart {
             public int breedingDelay = 6000;
+            public DyeColor defaultCollarColor = DyeColor.RED;
 
             public Ridable ridable;
             public class Ridable extends ConfigurationPart {
@@ -1291,6 +1293,7 @@ public class PurpurWorldConfiguration extends ConfigurationPart {
             public int breedingDelay = 6000;
             public double spawnRabidChance = 0.0D;
             public boolean milkCuresRabies = true;
+            public DyeColor defaultCollarColor = DyeColor.RED;
 
             public Ridable ridable;
             public class Ridable extends ConfigurationPart {
