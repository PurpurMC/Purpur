From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: William Blake Galbreath <Blake.Galbreath@GMail.com>
Date: Sun, 4 Oct 2020 19:08:53 -0500
Subject: [PATCH] Infinity bow settings


diff --git a/src/main/java/net/minecraft/world/item/BowItem.java b/src/main/java/net/minecraft/world/item/BowItem.java
index 08d597db1a5345a343777a01427655e6bf2c926b..aae5abbebc5834e8ff2f3a492acb76055abd769f 100644
--- a/src/main/java/net/minecraft/world/item/BowItem.java
+++ b/src/main/java/net/minecraft/world/item/BowItem.java
@@ -38,7 +38,7 @@ public class BowItem extends ProjectileWeaponItem implements Vanishable {
                 float f = BowItem.getPowerForTime(j);
 
                 if ((double) f >= 0.1D) {
-                    boolean flag1 = flag && itemstack1.is(Items.ARROW);
+                    boolean flag1 = flag && ((itemstack1.is(Items.ARROW) && world.purpurConfig().gameplayMechanics.infinity.normalArrows) || (itemstack1.is(Items.TIPPED_ARROW) && world.purpurConfig().gameplayMechanics.infinity.tippedArrows) || (itemstack1.is(Items.SPECTRAL_ARROW) && world.purpurConfig().gameplayMechanics.infinity.spectralArrows)); // Purpur
 
                     if (!world.isClientSide) {
                         ArrowItem itemarrow = (ArrowItem) (itemstack1.getItem() instanceof ArrowItem ? itemstack1.getItem() : Items.ARROW);
@@ -132,7 +132,7 @@ public class BowItem extends ProjectileWeaponItem implements Vanishable {
         ItemStack itemstack = user.getItemInHand(hand);
         boolean flag = !user.getProjectile(itemstack).isEmpty();
 
-        if (!user.getAbilities().instabuild && !flag) {
+        if (!(world.purpurConfig().gameplayMechanics.infinity.withoutArrows && EnchantmentHelper.getItemEnchantmentLevel(Enchantments.INFINITY_ARROWS, itemstack) > 0) && !user.getAbilities().instabuild && !flag) { // Purpur
             return InteractionResultHolder.fail(itemstack);
         } else {
             user.startUsingItem(hand);
diff --git a/src/main/java/org/purpurmc/purpur/configuration/PurpurWorldConfiguration.java b/src/main/java/org/purpurmc/purpur/configuration/PurpurWorldConfiguration.java
index 606fbfb0dfa1df17769f6d42ac35a72810a73fc3..09f390b95b0e71158b0a0694590443810fca3245 100644
--- a/src/main/java/org/purpurmc/purpur/configuration/PurpurWorldConfiguration.java
+++ b/src/main/java/org/purpurmc/purpur/configuration/PurpurWorldConfiguration.java
@@ -1476,6 +1476,14 @@ public class PurpurWorldConfiguration extends ConfigurationPart {
             public int snowball = -1;
             public int witherSkull = -1;
         }
+
+        public Infinity infinity;
+        public class Infinity extends ConfigurationPart {
+            public boolean withoutArrows = false;
+            public boolean normalArrows = true;
+            public boolean spectralArrows = false;
+            public boolean tippedArrows = false;
+        }
     }
 
     public Blocks blocks;
