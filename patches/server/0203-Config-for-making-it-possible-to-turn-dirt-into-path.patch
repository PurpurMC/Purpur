From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: 12emin34 <macanovic.emin@gmail.com>
Date: Thu, 29 Apr 2021 23:56:02 +0200
Subject: [PATCH] Config for making it possible to turn dirt into paths


diff --git a/src/main/java/net/minecraft/world/item/ItemSpade.java b/src/main/java/net/minecraft/world/item/ItemSpade.java
index 9ba8ae49e18fb8714b434715bd669b8e22004cd7..45a68e076072d653f04ee40746cb670e72cae227 100644
--- a/src/main/java/net/minecraft/world/item/ItemSpade.java
+++ b/src/main/java/net/minecraft/world/item/ItemSpade.java
@@ -23,6 +23,7 @@ public class ItemSpade extends ItemTool {
 
     private static final Set<Block> c = Sets.newHashSet(new Block[]{Blocks.CLAY, Blocks.DIRT, Blocks.COARSE_DIRT, Blocks.PODZOL, Blocks.FARMLAND, Blocks.GRASS_BLOCK, Blocks.GRAVEL, Blocks.MYCELIUM, Blocks.SAND, Blocks.RED_SAND, Blocks.SNOW_BLOCK, Blocks.SNOW, Blocks.SOUL_SAND, Blocks.GRASS_PATH, Blocks.WHITE_CONCRETE_POWDER, Blocks.ORANGE_CONCRETE_POWDER, Blocks.MAGENTA_CONCRETE_POWDER, Blocks.LIGHT_BLUE_CONCRETE_POWDER, Blocks.YELLOW_CONCRETE_POWDER, Blocks.LIME_CONCRETE_POWDER, Blocks.PINK_CONCRETE_POWDER, Blocks.GRAY_CONCRETE_POWDER, Blocks.LIGHT_GRAY_CONCRETE_POWDER, Blocks.CYAN_CONCRETE_POWDER, Blocks.PURPLE_CONCRETE_POWDER, Blocks.BLUE_CONCRETE_POWDER, Blocks.BROWN_CONCRETE_POWDER, Blocks.GREEN_CONCRETE_POWDER, Blocks.RED_CONCRETE_POWDER, Blocks.BLACK_CONCRETE_POWDER, Blocks.SOUL_SOIL});
     protected static final Map<Block, IBlockData> a = Maps.newHashMap(ImmutableMap.of(Blocks.GRASS_BLOCK, Blocks.GRASS_PATH.getBlockData()));
+    protected static final Map<Block, IBlockData> flattenablesWithDirt = Maps.newHashMap(ImmutableMap.of(Blocks.GRASS_BLOCK, Blocks.GRASS_PATH.getBlockData(), Blocks.DIRT, Blocks.GRASS_PATH.getBlockData(), Blocks.COARSE_DIRT, Blocks.GRASS_PATH.getBlockData())); // Purpur
 
     public ItemSpade(ToolMaterial toolmaterial, float f, float f1, Item.Info item_info) {
         super(f, f1, toolmaterial, ItemSpade.c, item_info);
@@ -43,7 +44,7 @@ public class ItemSpade extends ItemTool {
             return EnumInteractionResult.PASS;
         } else {
             EntityHuman entityhuman = itemactioncontext.getEntity();
-            IBlockData iblockdata1 = (IBlockData) ItemSpade.a.get(iblockdata.getBlock());
+            IBlockData iblockdata1 = (IBlockData) (world.purpurConfig.shovelTurnsDirtToPath ? flattenablesWithDirt : ItemSpade.a).get(iblockdata.getBlock()); // Purpur
             IBlockData iblockdata2 = null;
 
             if (iblockdata1 != null && world.getType(blockposition.up()).isAir()) {
diff --git a/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java b/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
index 69d6ced8e583a3a0625ced9d444caca21fa80723..db2f91bde801e910f550e22fe3d9696397e8493e 100644
--- a/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
+++ b/src/main/java/net/pl3x/purpur/PurpurWorldConfig.java
@@ -457,6 +457,11 @@ public class PurpurWorldConfig {
         totemOfUndyingWorksInInventory = getBoolean("gameplay-mechanics.player.totem-of-undying-works-in-inventory", totemOfUndyingWorksInInventory);
     }
 
+    public boolean shovelTurnsDirtToPath = false;
+    private void shovelSettings() {
+        shovelTurnsDirtToPath = getBoolean("gameplay-mechanics.shovel-turns-dirt-to-path", false);
+    }
+
     public boolean silkTouchEnabled = false;
     public String silkTouchSpawnerName = "Spawner";
     public List<String> silkTouchSpawnerLore = new ArrayList<>();
