From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: David Luedtke <david@ldtke.de>
Date: Tue, 29 Jun 2021 22:39:28 +0200
Subject: [PATCH] remove deobf of stacktraces again


diff --git a/build.gradle.kts b/build.gradle.kts
index f766183883f009368b79e1201553c184a373e2cf..fd54481ceaea4e5cbc0e99cee303c1bdeafc5919 100644
--- a/build.gradle.kts
+++ b/build.gradle.kts
@@ -133,44 +133,6 @@ tasks.shadowJar {
     transform(ModifiedLog4j2PluginsCacheFileTransformer::class.java)
 }
 
-// Paper start - include reobf mappings in jar for stacktrace deobfuscation
-abstract class IncludeMappings : BaseTask() {
-    @get:InputFile
-    abstract val inputJar: RegularFileProperty
-
-    @get:InputFile
-    abstract val mappings: RegularFileProperty
-
-    @get:OutputFile
-    abstract val outputJar: RegularFileProperty
-
-    override fun init() {
-        outputJar.convention(defaultOutput())
-    }
-
-    @TaskAction
-    private fun addMappings() {
-        outputJar.get().asFile.parentFile.mkdirs()
-        inputJar.get().asFile.copyTo(outputJar.get().asFile, overwrite = true)
-        outputJar.get().path.openZip().use { fs ->
-            val dir = fs.getPath("META-INF/mappings/")
-            Files.createDirectories(dir)
-            val target = dir.resolve("reobf.tiny")
-            Files.copy(mappings.path, target)
-        }
-    }
-}
-
-val includeMappings = tasks.register<IncludeMappings>("includeMappings") {
-    inputJar.set(tasks.fixJarForReobf.flatMap { it.outputJar })
-    mappings.set(tasks.reobfJar.flatMap { it.mappingsFile })
-}
-
-tasks.reobfJar {
-    inputJar.set(includeMappings.flatMap { it.outputJar })
-}
-// Paper end - include reobf mappings in jar for stacktrace deobfuscation
-
 tasks.test {
     exclude("org/bukkit/craftbukkit/inventory/ItemStack*Test.class")
 }
