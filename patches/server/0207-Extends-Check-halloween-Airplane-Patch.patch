From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: DoctaEnkoda <bierquejason@gmail.com>
Date: Fri, 7 May 2021 03:35:42 +0200
Subject: [PATCH] Extends Check halloween Airplane Patch


diff --git a/src/main/java/net/minecraft/world/entity/ambient/EntityBat.java b/src/main/java/net/minecraft/world/entity/ambient/EntityBat.java
index 88a0d51f78bee9a1b0762b46db4d91a9f8f8c75d..2af1fa1013899176469dbd78774ce5d51eb4234f 100644
--- a/src/main/java/net/minecraft/world/entity/ambient/EntityBat.java
+++ b/src/main/java/net/minecraft/world/entity/ambient/EntityBat.java
@@ -307,22 +307,9 @@ public class EntityBat extends EntityAmbient {
         }
     }
 
-    // Airplane start - only check for spooky season once an hour
-    private static boolean isSpookySeason = false;
-    private static final int ONE_HOUR = 20 * 60 * 60;
-    private static int lastSpookyCheck = -ONE_HOUR;
     private static boolean eJ() {
-        if (MinecraftServer.currentTick - lastSpookyCheck > ONE_HOUR) {
-        LocalDate localdate = LocalDate.now();
-        int i = localdate.get(ChronoField.DAY_OF_MONTH);
-        int j = localdate.get(ChronoField.MONTH_OF_YEAR);
-            isSpookySeason = j == 10 && i >= 20 || j == 11 && i <= 3;
-            lastSpookyCheck = MinecraftServer.currentTick;
-        }
-
-        return isSpookySeason;
+        return net.pl3x.purpur.utils.EventsYear.checkSpookySeason(); // Purpur
     }
-    // Airplane end
 
     @Override
     protected float b(EntityPose entitypose, EntitySize entitysize) {
diff --git a/src/main/java/net/minecraft/world/entity/monster/EntitySkeletonAbstract.java b/src/main/java/net/minecraft/world/entity/monster/EntitySkeletonAbstract.java
index 7ec60987229927e5fe7164f1d4eae8222832e920..71a821133fb896ac15e8a7249158c22c7bfd4022 100644
--- a/src/main/java/net/minecraft/world/entity/monster/EntitySkeletonAbstract.java
+++ b/src/main/java/net/minecraft/world/entity/monster/EntitySkeletonAbstract.java
@@ -154,11 +154,7 @@ public abstract class EntitySkeletonAbstract extends EntityMonster implements IR
         this.eL();
         this.setCanPickupLoot(this.world.paperConfig.skeletonsAlwaysCanPickUpLoot || this.random.nextFloat() < 0.55F * difficultydamagescaler.d()); // Paper
         if (this.getEquipment(EnumItemSlot.HEAD).isEmpty()) {
-            LocalDate localdate = LocalDate.now();
-            int i = localdate.get(ChronoField.DAY_OF_MONTH);
-            int j = localdate.get(ChronoField.MONTH_OF_YEAR);
-
-            if (j == 10 && i == 31 && this.random.nextFloat() < 0.25F) {
+            if (net.pl3x.purpur.utils.EventsYear.checkHalloween() && this.random.nextFloat() < 0.25F) { // Purpur
                 this.setSlot(EnumItemSlot.HEAD, new ItemStack(this.random.nextFloat() < 0.1F ? Blocks.JACK_O_LANTERN : Blocks.CARVED_PUMPKIN));
                 this.dropChanceArmor[EnumItemSlot.HEAD.b()] = 0.0F;
             }
diff --git a/src/main/java/net/minecraft/world/entity/monster/EntityZombie.java b/src/main/java/net/minecraft/world/entity/monster/EntityZombie.java
index 7112db516e62ca75a445482005c524129b84f54c..6e1926698fed582f769a9c0390b0da497d4c29b3 100644
--- a/src/main/java/net/minecraft/world/entity/monster/EntityZombie.java
+++ b/src/main/java/net/minecraft/world/entity/monster/EntityZombie.java
@@ -585,11 +585,7 @@ public class EntityZombie extends EntityMonster {
         }
 
         if (this.getEquipment(EnumItemSlot.HEAD).isEmpty()) {
-            LocalDate localdate = LocalDate.now();
-            int i = localdate.get(ChronoField.DAY_OF_MONTH);
-            int j = localdate.get(ChronoField.MONTH_OF_YEAR);
-
-            if (j == 10 && i == 31 && this.random.nextFloat() < 0.25F) {
+            if (net.pl3x.purpur.utils.EventsYear.checkHalloween() && this.random.nextFloat() < 0.25F) { // Purpur
                 this.setSlot(EnumItemSlot.HEAD, new ItemStack(this.random.nextFloat() < 0.1F ? Blocks.JACK_O_LANTERN : Blocks.CARVED_PUMPKIN));
                 this.dropChanceArmor[EnumItemSlot.HEAD.b()] = 0.0F;
             }
diff --git a/src/main/java/net/pl3x/purpur/utils/EventsYear.java b/src/main/java/net/pl3x/purpur/utils/EventsYear.java
new file mode 100644
index 0000000000000000000000000000000000000000..7d44659aaed6ef151854bb0087d68a218b9719d3
--- /dev/null
+++ b/src/main/java/net/pl3x/purpur/utils/EventsYear.java
@@ -0,0 +1,39 @@
+package net.pl3x.purpur.utils;
+
+import net.minecraft.server.MinecraftServer;
+
+import java.time.LocalDate;
+import java.time.temporal.ChronoField;
+
+public class EventsYear {
+
+    // Airplane start - only check for spooky season once an hour - Purpur rebase
+    private static boolean isSpookySeason = false;
+    private static final int ONE_HOUR = 20 * 60 * 60;
+    private static int lastSpookyCheck = -ONE_HOUR;
+
+    public static boolean checkSpookySeason() {
+        if (MinecraftServer.currentTick - lastSpookyCheck > ONE_HOUR) {
+            LocalDate localdate = LocalDate.now();
+            int day = localdate.get(ChronoField.DAY_OF_MONTH);
+            int month = localdate.get(ChronoField.MONTH_OF_YEAR);
+            isSpookySeason = month == 10 && day >= 20 || month == 11 && day <= 3;
+            lastSpookyCheck = MinecraftServer.currentTick;
+        }
+        return isSpookySeason;
+    }
+    // Airplane end - Purpur Rebase End
+
+    private static boolean isHalloween = false;
+    private static int lastHalloweenCheck = -ONE_HOUR;
+    public static boolean checkHalloween() {
+        if (MinecraftServer.currentTick - lastHalloweenCheck > ONE_HOUR) {
+            LocalDate localdate = LocalDate.now();
+            int day = localdate.get(ChronoField.DAY_OF_MONTH);
+            int month = localdate.get(ChronoField.MONTH_OF_YEAR);
+            isHalloween =  month == 10 && day == 31;
+            lastHalloweenCheck = MinecraftServer.currentTick;
+        }
+        return isHalloween;
+    }
+}
\ No newline at end of file
